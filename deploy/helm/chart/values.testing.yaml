# Testing env overrides
deployTarget: "testing"

# Enable test-server in testing environment
testServer:
  enabled: false
  replicas: 1
  image:
    repository: udpchatnewacr.azurecr.io/test-server
    tag: latest
    pullPolicy: IfNotPresent
  resources: {}

testing:
  enableDb: true
  tlsEnabled: true
  db:
    # Use DB_PASSWORD key from udpchat-app secret for Postgres password
    passwordKey: DB_PASSWORD

# Use fewer replicas by default in testing
nginx:
  replicas: 1
  env:
    WS_URL: "ws://connector:8001/ws"  # WebSocket URL for testing
    APP_VERSION: "testing"
    NODE_ENV: "testing"

connector:
  replicas: 1
  env: {}

udp:
  replicas: 1
  port: 9999
  env:
    DB_HOST: "postgres"
    DB_PORT: "5432"
    DB_NAME: "udpchat"
    DB_USER: "udpchat"
    AI_MODE: "gpt"

# For testing, use pre-applied secret.testing.yaml (existing secret)
existingAppSecret:
  enabled: true
  name: udpchat-app

# Certificate defaults for testing (HTTP-01 via ClusterIssuer)
certificate:
  create: true
  secretName: udpchat-testing-tls
  issuer:
    kind: ClusterIssuer
    name: letsencrypt-prod

